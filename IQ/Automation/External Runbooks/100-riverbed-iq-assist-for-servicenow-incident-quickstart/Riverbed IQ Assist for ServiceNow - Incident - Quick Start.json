{
    "runbook": {
        "id": "db8e0fd0-8ea7-4433-98bd-d93ada11d815",
        "createdTime": "1760697733.241103000",
        "lastUpdatedTime": "1760955393.199825600",
        "factoryResourceName": null,
        "isFactory": false,
        "name": "Riverbed IQ Assist for ServiceNow - Incident - Quick Start",
        "description": "This quick start runbook can be used as-is for Incidents assistance with Riverbed IQ Assist for ServiceNow. When triggered from ServiceNow, the runbook diagnoses the end-user endpoint and updates the incident ticket.",
        "isReady": true,
        "triggerType": "webhook",
        "runtimeVariables": {
            "primitiveVariables": [
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.ServiceNow_Incident_Sys_Id",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.ServiceNow_Configuration_Item",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.ServiceNow_Configuration_Item_Sys_Id",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.ServiceNow_Incident_Number",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.Insight",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.User_Endpoint_Name",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.Findings_Health",
                    "isReadonly": false
                },
                {
                    "type": "boolean",
                    "defaultValue": null,
                    "name": "runtime.Successful",
                    "isReadonly": false
                },
                {
                    "type": "string",
                    "defaultValue": null,
                    "name": "runtime.Error_Message",
                    "isReadonly": false
                }
            ],
            "structuredVariables": []
        },
        "subflowVariables": null,
        "nodes": [
            {
                "id": "e54f5bc2-8f7e-4cca-9344-87f625c957c1",
                "isIntegrationSubflowNode": false,
                "type": "trigger",
                "label": "Riverbed IQ Assist in ServiceNow Incident",
                "description": "",
                "properties": {
                    "x": 353,
                    "y": 625,
                    "triggerType": "webhook",
                    "timeReference": "RUNBOOK_EXECUTION",
                    "timeOffset": 900,
                    "debug": false
                },
                "wires": [
                    [
                        "5bacc4de-dce0-4413-9916-10d0c54ab14e"
                    ]
                ]
            },
            {
                "id": "9100d8f4-94f1-4647-bcd4-2a2d105ae5a1",
                "isIntegrationSubflowNode": false,
                "type": "comment",
                "label": "Comment",
                "description": "",
                "properties": {
                    "x": 50,
                    "y": 430,
                    "comment": "<p dir=\"ltr\" class=\"editor-paragraph\"><b><strong style=\"white-space: pre-wrap;\" class=\"editor-text-bold\">Riverbed IQ Assist for ServiceNow</strong></b></p><p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\">Runbook for Incident in ServiceNow: Quick Start for diagnosing the user endpoint.</span></p><p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\">version: 2025-10-20-1</span></p>",
                    "debug": false
                },
                "wires": []
            },
            {
                "id": "f4e3d33b-393c-484f-b51f-3c2587fe28c8",
                "isIntegrationSubflowNode": false,
                "type": "comment",
                "label": "Comment 2",
                "description": "",
                "properties": {
                    "x": 51,
                    "y": 665,
                    "comment": "<p dir=\"ltr\" class=\"editor-paragraph\"><b><strong style=\"white-space: pre-wrap;\" class=\"editor-text-bold\">Payload example</strong></b></p><p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\">{</span><br><span style=\"white-space: pre-wrap;\">\"recordNumber\" : \"INC0013262\",</span><br><span style=\"white-space: pre-wrap;\">\"ciName\" : \"Adam_Covert_WKS\"</span><br><span style=\"white-space: pre-wrap;\">}</span></p>",
                    "debug": false
                },
                "wires": []
            },
            {
                "id": "5bacc4de-dce0-4413-9916-10d0c54ab14e",
                "isIntegrationSubflowNode": false,
                "type": "set_primitive_variables",
                "label": "Extract info",
                "description": "",
                "properties": {
                    "x": 536,
                    "y": 625,
                    "variables": [
                        {
                            "name": "runtime.ServiceNow_Incident_Sys_Id"
                        },
                        {
                            "name": "runtime.ServiceNow_Incident_Number"
                        },
                        {
                            "name": "runtime.ServiceNow_Configuration_Item"
                        },
                        {
                            "name": "runtime.ServiceNow_Configuration_Item_Sys_Id"
                        },
                        {
                            "name": "runtime.User_Endpoint_Name"
                        }
                    ],
                    "transformTemplate": "{\n\"runtime.ServiceNow_Incident_Sys_Id\": \"{{trigger[\"requestBody\"][\"recordID\"]}}\",\n\"runtime.ServiceNow_Configuration_Item\": \"{{trigger[\"requestBody\"][\"ciName\"]}}\",\n\"runtime.ServiceNow_Configuration_Item_Sys_Id\": \"{{trigger[\"requestBody\"][\"ciID\"]}}\",\n\"runtime.ServiceNow_Incident_Number\": \"{{trigger[\"requestBody\"][\"recordNumber\"]}}\",\n\"runtime.User_Endpoint_Name\": \"{{trigger[\"requestBody\"][\"ciName\"]}}\"\n}",
                    "debug": false
                },
                "wires": [
                    [
                        "7e2f5b07-6600-41ae-9c5b-b31b2d37d5bc",
                        "eb949989-fab3-457f-a33b-8d28d21b02d0"
                    ]
                ]
            },
            {
                "id": "7a01b9f9-5ebf-4005-b5c8-36bbcbe8a330",
                "isIntegrationSubflowNode": false,
                "type": "genai",
                "label": "IQ Assist: Diagnose Health Events (GenAI)",
                "description": "",
                "properties": {
                    "x": 1404.8601058869017,
                    "y": 615,
                    "instructions": "You are Riverbed IQ Assist, a trusted and expert assistant specializing in diagnosing and troubleshooting issues related to end-user endpoints (Windows, Mac). \nYour analyze recent health events that can impact the stability of the device. Follow these instructions carefully:\n\n1. Adopt the persona of a professional, concise analyst specializing in troubleshooting performance issues related to endpoints and applications.\n2. Process the provided data thoroughly to analyze anomalies. Focus on identifying the **top 5 most relevant findings or anomalies** that are critical to performance.\n3. For each identified issue, include a brief but detailed summary explaining the finding, why it is important, and its potential impact on the system or user experience.\n4. Structure each finding as an itemized, numbered list within an HTML `<div>` tag to ensure easily readable output. Each item should clearly and concisely describe the issue while maintaining a professional tone.\n5. Ensure that the information is organized, unambiguous, and actionable for the person relying on it.\n6. Your response should strictly adhere to the structure below, with no additional commentary or explanation outside the HTML format, as shown in this example :\n\"\"\"\n<b>Health Events</b>\n<br>\n<div>\n    <p><b>Finding #1:</b> [Issue description]. <br><b>Explanation</b>: [Why this matters and the potential impact].</p>\n    <p><b>Finding #2:</b> [Issue description]. <br><b>Explanation</b>: [Why this matters and the potential impact].</p>\n    <p><b>Finding #3:</b> [Issue description]. <br><b>Explanation</b>: [Why this matters and the potential impact].</p>\n    <p><b>Finding #4:</b> [Issue description]. <br><b>Explanation</b>: [Why this matters and the potential impact].</p>\n    <p><b>Finding #5:</b> [Issue description]. <br><b>Explanation</b>: [Why this matters and the potential impact].</p>\n</div>\n<div>\n<p><small>AI-generated content</small></p>\n</div>\n\"\"\"\n\nOnly include the top 5 most relevant findings, and no more than 5. Avoid redundancies and keep the focus on critical insights.",
                    "instructionsLocation": "enter",
                    "queryLocation": "$parent",
                    "debug": false
                },
                "wires": [
                    [
                        "83b3c687-5784-43d8-a5de-eb6cdce87409"
                    ]
                ]
            },
            {
                "id": "83b3c687-5784-43d8-a5de-eb6cdce87409",
                "isIntegrationSubflowNode": false,
                "type": "set_primitive_variables",
                "label": "Collect Health Findings",
                "description": "",
                "properties": {
                    "x": 1605.4006906480286,
                    "y": 615,
                    "variables": [
                        {
                            "name": "runtime.Findings_Health"
                        }
                    ],
                    "transformTemplate": "{%- assign html = node_input.output.data[0].keys['gen_ai.response'] | replace: '```html', \"\" | replace: '\"\"\"', \"\" | replace: '```', \"\" | replace: '\\n', \"\" | replace: '\\\"', \"&quot;\" -%}\n{\n\"runtime.Findings_Health\": \"{{ html }}\"\n}",
                    "debug": false
                },
                "wires": [
                    [
                        "b319018c-7605-417b-976e-8fc42038954c"
                    ]
                ]
            },
            {
                "id": "1f1f8fb4-4ac1-4d2a-a740-bde6954c2e65",
                "isIntegrationSubflowNode": false,
                "type": "subflow",
                "label": "ServiceNow: Post Work Notes",
                "description": "",
                "properties": {
                    "x": 2054.400690648028,
                    "y": 665,
                    "debug": false,
                    "configurationId": "f4c88032-d05f-4d27-ad96-a1f844c66ba5",
                    "in": [
                        {
                            "inner": "subflow.Connector",
                            "outer": "00000000-0000-0000-0000-000000000000",
                            "method": "connector"
                        },
                        {
                            "inner": "subflow.Record_Type",
                            "outer": "incident",
                            "method": "static",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Sys_Id",
                            "outer": "runtime.ServiceNow_Incident_Sys_Id",
                            "method": "runtime",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Content",
                            "outer": "runtime.Insight",
                            "method": "runtime",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Visibility",
                            "outer": "work_notes",
                            "method": "static",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Format",
                            "outer": "html",
                            "method": "static"
                        }
                    ],
                    "out": [
                        {
                            "inner": "subflow.Successful",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.Error_Message",
                            "outer": ""
                        }
                    ]
                },
                "wires": []
            },
            {
                "id": "51557cab-8c6c-4bcf-94c6-9cfea5c5fb77",
                "isIntegrationSubflowNode": false,
                "type": "rvbd_ui_text",
                "label": "Display Insight",
                "description": "",
                "properties": {
                    "x": 2055.860105886901,
                    "y": 540,
                    "title": "Riverbed IQ Assist",
                    "row": "1",
                    "notes": "<p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\"><span class=\"editor-variable-inner\">{{variables[\"runtime.Insight\"]}}</span></span></p>",
                    "debug": false
                },
                "wires": []
            },
            {
                "id": "ad517cb8-c77a-46b0-b4a5-8aebdc763881",
                "isIntegrationSubflowNode": false,
                "type": "data_ocean_dynamic",
                "label": "Fetch Health Events (Data Store)",
                "description": "",
                "properties": {
                    "x": 962.8601058869012,
                    "y": 620,
                    "objType": "aternity_device_health_events_hourly.traffic",
                    "timeSeries": false,
                    "limit": 10,
                    "topBy": [
                        {
                            "id": "sum_unique_health_events",
                            "direction": "desc"
                        }
                    ],
                    "groupBy": [
                        "health_event_name",
                        "health_event_severity",
                        "health_event_status",
                        "health_event_category",
                        "health_event_sub_category",
                        "health_event_component",
                        "health_event_details",
                        "health_event_last_timestamp"
                    ],
                    "duration": 604800,
                    "filters": {
                        "userDevice": [
                            "$node:7e2f5b07-6600-41ae-9c5b-b31b2d37d5bc.user_device"
                        ]
                    },
                    "debug": false
                },
                "wires": [
                    [
                        "671f7895-3254-470d-93ce-9a6abde17192"
                    ]
                ]
            },
            {
                "id": "7e2f5b07-6600-41ae-9c5b-b31b2d37d5bc",
                "isIntegrationSubflowNode": false,
                "type": "subflow",
                "label": "Fetch User Endpoint (Aternity EUEM)",
                "description": "This subflow takes one or more device names as a comma separated list and outputs User Device objects.",
                "properties": {
                    "x": 757,
                    "y": 620,
                    "debug": false,
                    "configurationId": "352073eb-8d20-4cab-9f7f-db36234a1f51",
                    "in": [
                        {
                            "inner": "subflow.Device_Name_List",
                            "outer": "runtime.User_Endpoint_Name",
                            "method": "runtime",
                            "isUnset": false
                        }
                    ],
                    "out": []
                },
                "wires": [
                    [
                        "ad517cb8-c77a-46b0-b4a5-8aebdc763881"
                    ]
                ]
            },
            {
                "id": "eb949989-fab3-457f-a33b-8d28d21b02d0",
                "isIntegrationSubflowNode": false,
                "type": "insight",
                "label": "Display Info",
                "description": "",
                "properties": {
                    "x": 755.2042182590283,
                    "y": 540,
                    "template": "<p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\">User Endpoint: </span><b><span style=\"white-space: pre-wrap;\"><strong class=\"editor-variable-inner\">{{variables[\"runtime.User_Endpoint_Name\"]}}</strong></span></b></p><p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\">ServiceNow Incident Number: </span><b><strong style=\"white-space: pre-wrap;\" class=\"editor-text-bold\">{{variables[\"runtime.ServiceNow_Incident_Number\"]}}</strong></b></p>",
                    "debug": false
                },
                "wires": []
            },
            {
                "id": "b319018c-7605-417b-976e-8fc42038954c",
                "isIntegrationSubflowNode": false,
                "type": "subflow",
                "label": "Skill: Generate Insight",
                "description": "Generate an HTML formatted insight with charts, that is ready to be displayed in ServiceNow or anywhere else.",
                "properties": {
                    "x": 1812.8601058869017,
                    "y": 620,
                    "debug": false,
                    "configurationId": "63ff53ff-b315-4915-bb88-2c7abf9ec24f",
                    "in": [
                        {
                            "inner": "subflow.Findings_HEALTH",
                            "outer": "runtime.Findings_Health",
                            "method": "runtime",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Findings_IO",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.Findings_WIFI",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.Findings_CPU_MEM",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.Findings_NPM",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_WIFI_Signal_Strength",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_CPU_MEM",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_WIFI_Transmission_Speed",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_NPM_Traffic",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_NPM_RTCC",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_IO_RATE_RW",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.SVG_IO_DISK_QUEUE_LENGTH",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.Format",
                            "outer": ""
                        }
                    ],
                    "out": [
                        {
                            "inner": "subflow.Successful",
                            "outer": "runtime.Successful",
                            "method": "runtime"
                        },
                        {
                            "inner": "subflow.Error_Message",
                            "outer": "runtime.Error_Message",
                            "method": "runtime"
                        },
                        {
                            "inner": "subflow.Insight",
                            "outer": "runtime.Insight",
                            "method": "runtime"
                        }
                    ]
                },
                "wires": [
                    [
                        "51557cab-8c6c-4bcf-94c6-9cfea5c5fb77",
                        "1f1f8fb4-4ac1-4d2a-a740-bde6954c2e65"
                    ]
                ]
            },
            {
                "id": "671f7895-3254-470d-93ce-9a6abde17192",
                "isIntegrationSubflowNode": false,
                "type": "decision",
                "label": "Found?",
                "description": "",
                "properties": {
                    "x": 1178.655887627872,
                    "y": 620,
                    "dataType": "SUMMARY",
                    "inputType": "aternity_device_health_events_hourly.traffic",
                    "outputs": [
                        {
                            "id": "o08178",
                            "passedData": "MATCHED",
                            "expression": {
                                "id": "o5957",
                                "type": "block",
                                "operation": "AND",
                                "conditions": [
                                    {
                                        "type": "condition",
                                        "id": "c-1760700774013",
                                        "category": "input.rows",
                                        "key": "count",
                                        "op": "GT",
                                        "value": "0"
                                    }
                                ]
                            },
                            "label": "Found"
                        },
                        {
                            "id": "o19799",
                            "passedData": "MATCHED",
                            "expression": {
                                "id": "o4547",
                                "type": "block",
                                "operation": "AND",
                                "conditions": [
                                    {
                                        "type": "condition",
                                        "id": "c-1760700819305",
                                        "category": "input.rows",
                                        "key": "count",
                                        "op": "EQ",
                                        "value": "0"
                                    }
                                ]
                            },
                            "label": "Not Found"
                        }
                    ],
                    "debug": false
                },
                "wires": [
                    [
                        "7a01b9f9-5ebf-4005-b5c8-36bbcbe8a330"
                    ],
                    [
                        "df35e11b-4d27-4afa-8df2-c1411bf9a9a7",
                        "71c69dcb-60ee-4fd1-8ec2-9bf6869efa66"
                    ]
                ]
            },
            {
                "id": "df35e11b-4d27-4afa-8df2-c1411bf9a9a7",
                "isIntegrationSubflowNode": false,
                "type": "subflow",
                "label": "ServiceNow: Post Data Not Found",
                "description": "",
                "properties": {
                    "x": 1410.4006906480286,
                    "y": 905,
                    "debug": false,
                    "configurationId": "f4c88032-d05f-4d27-ad96-a1f844c66ba5",
                    "in": [
                        {
                            "inner": "subflow.Connector",
                            "outer": "00000000-0000-0000-0000-000000000000",
                            "method": "connector"
                        },
                        {
                            "inner": "subflow.Record_Type",
                            "outer": "incident",
                            "method": "static",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Sys_Id",
                            "outer": "runtime.ServiceNow_Incident_Sys_Id",
                            "method": "runtime",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Content",
                            "outer": "Data not found. Please check the CI contains the name of the User Endpoint",
                            "method": "static",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Visibility",
                            "outer": "work_notes",
                            "method": "static",
                            "isUnset": false
                        },
                        {
                            "inner": "subflow.Format",
                            "outer": "html",
                            "method": "static"
                        }
                    ],
                    "out": [
                        {
                            "inner": "subflow.Successful",
                            "outer": ""
                        },
                        {
                            "inner": "subflow.Error_Message",
                            "outer": ""
                        }
                    ]
                },
                "wires": []
            },
            {
                "id": "71c69dcb-60ee-4fd1-8ec2-9bf6869efa66",
                "isIntegrationSubflowNode": false,
                "type": "rvbd_ui_text",
                "label": "Display Error",
                "description": "",
                "properties": {
                    "x": 1407,
                    "y": 760,
                    "title": "Error message",
                    "row": "1",
                    "notes": "<p dir=\"ltr\" class=\"editor-paragraph\"><span style=\"white-space: pre-wrap;\">No data found. Please check the CI contains the name of the User Endpoint</span></p>",
                    "debug": false
                },
                "wires": []
            }
        ],
        "lastUpdatedUser": "Runbook Export",
        "createdByUser": "Runbook Export",
        "eTag": "W/\"datetime'2025-10-20T10%3A16%3A33.2102759Z'\"",
        "variant": "incident",
        "seriesId": "db8e0fd0-8ea7-4433-98bd-d93ada11d815",
        "version": "1.0",
        "otherVersions": null,
        "isScheduled": false,
        "isValidated": true,
        "isProprietary": false
    },
    "dependencies": [
        {
            "id": "f4c88032-d05f-4d27-ad96-a1f844c66ba5",
            "type": "subflow",
            "name": "ServiceNow: Post Comment",
            "globalId": "ServiceNow::Post_Comment",
            "originalVersion": "1.0.4",
            "nodeLabel": "ServiceNow: Post Work Notes",
            "sourceLocation": "integrationLibrary",
            "sourcePackageId": "ServiceNow"
        },
        {
            "id": "352073eb-8d20-4cab-9f7f-db36234a1f51",
            "type": "subflow",
            "name": "Aternity: Create User Device",
            "globalId": "Aternity::Create_User_Device",
            "originalVersion": "1.0.2",
            "nodeLabel": "Fetch User Endpoint (Aternity EUEM)",
            "sourceLocation": "integrationLibrary",
            "sourcePackageId": "Aternity"
        },
        {
            "id": "63ff53ff-b315-4915-bb88-2c7abf9ec24f",
            "type": "subflow",
            "name": "Skill: Generate Insight",
            "globalId": "RiverbedIQAssist::Generate_Insight",
            "originalVersion": "1.0.2",
            "nodeLabel": "Skill: Generate Insight",
            "sourceLocation": "integrationLibrary",
            "sourcePackageId": "RiverbedIQAssist"
        },
        {
            "id": "f4c88032-d05f-4d27-ad96-a1f844c66ba5",
            "type": "subflow",
            "name": "ServiceNow: Post Comment",
            "globalId": "ServiceNow::Post_Comment",
            "originalVersion": "1.0.4",
            "nodeLabel": "ServiceNow: Post Data Not Found",
            "sourceLocation": "integrationLibrary",
            "sourcePackageId": "ServiceNow"
        }
    ],
    "token": "qlPOQXeijL8ywAA8x/FUijjx+q8HKw04rct/Ffpo6eg="
}